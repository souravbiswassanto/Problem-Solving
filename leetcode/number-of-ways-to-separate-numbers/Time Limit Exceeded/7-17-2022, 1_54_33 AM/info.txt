{"id":748804480,"lang":"cpp","time":"3 weeks, 2 days","timestamp":1658001273,"status_display":"Time Limit Exceeded","runtime":"N/A","url":"/submissions/detail/748804480/","is_pending":"Not Pending","title":"Number of Ways to Separate Numbers","memory":"N/A","code":"class Solution {\npublic:\n    const int mod = 1e9 + 7;\n    \n    vector<int>z_function(string& s){\n    int n = (int) s.length();\n    vector < int > Z(n);\n    Z[0] = 0; \n    for (int i = 1, L = 0, R = 0; i < n; ++i)\n    {\n        if (i <= R) \n            Z[i] = min (R - i + 1, Z[i - L]); \n        else\n            Z[i] = 0; \n        while (i + Z[i] < n && s[Z[i]] == s[i + Z[i]]) \n            ++Z[i]; \n        if (i + Z[i] - 1 > R) \n            L = i, R = i + Z[i] - 1;\n    }\n        return Z;\n}\n    \n    int calc (int idx, int last, int n, string& num, vector<vector<int>>& match, vector<vector<int>>& dp){\n            //cout << idx <<\" \" << last << endl;\n            if(idx > n)return 0;\n            if(idx == n)return 1;\n            int &ret = dp[idx][last];\n            if(ret != -1)return ret;\n            ret = 0;\n            int start = (match[idx][last] == 1)?last: last + 1;\n            if(num[idx] =='0')return 0;\n            for(int i = start; i <= n; i++){\n                if(idx + i > n)break;\n                ret = (ret + calc(idx + i, i, n, num, match, dp)) % mod;\n            }\n            return ret;\n        };\n    int numberOfCombinations(string num) {\n        int n = num.size();\n        vector<vector<int>> match(n + 4, vector<int>(n + 4, 0));\n        vector<vector<int>> dp(n + 4, vector<int>(n + 4, -1));\n        \n        for(int i = 0; i < n; i++){\n            string s = \"\";\n            for(int j = i; j < n; j++)s += num[j];\n            s += '#';\n            s += num;\n            vector<int> Z = z_function(s);\n            for(int j = 1; j < n; j++){\n                if(i + j >= n)break;\n                match[i][i + j] = Z[n + j + 1];\n                //cout << i <<\" \" << i + j << \" \" << match[i][i + j] << endl;\n            }\n        }\n        \n        for(int i = 0; i < n; i++){\n            for(int j = 1; j < n; j++){\n                if(i + j > n)break;\n                if(i - j < 0)break;\n                \n                int a = match[i - j][i];\n                if(a >= j or num[i - j + a] <= num[i + a]){\n                    match[i][j] = 1;\n                }\n                else match[i][j] = 0;\n            }\n        }\n        \n        int ans = calc(0, 0, n, num, match, dp);\n        return ans;\n    }\n};","compare_result":"11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111110","title_slug":"number-of-ways-to-separate-numbers"}